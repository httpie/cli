on:
  pull_request:
    paths:
      - .github/workflows/windows-chocolatey.yml
      - docs/packaging/windows-chocolatey/httpie.nuspec
      - docs/packaging/windows-chocolateytools/*.ps1

jobs:
  snap:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build
        run: choco pack
        working-directory: docs/packaging/windows-chocolatey
      - name: Check metadata
        run: choco info httpie -s .
        working-directory: docs/packaging/windows-chocolatey
      - name: Install
        run: choco install httpie -y -dv -s .
        working-directory: docs/packaging/windows-chocolatey
      - name: Test
        run: |
          http --version
          https --version
